<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>KCI Case Tracker ‚Äì Upload Excel Creation Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css" />

  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="index.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.4.0/css/fixedHeader.dataTables.min.css">
</head>
<body>

<header class="app-header">
  <div class="header-content">
    <div>
      <span class="header-title">KCI Case Tracker</span>
      <p class="header-subtitle">Upload Excel Creation Tool</p>
    </div>
    <div class="header-actions">
      <button id="themeToggle" class="icon-button" title="Toggle theme">üåô</button>
    </div>
  </div>
</header>

<div class="container">

  <!-- ‚úÖ CONTROL CENTER -->
  <div class="control-center">
    <div class="control-grid">
      <section class="panel upload-panel">
        <div class="panel-header">
          <h2>Upload source files</h2>
          <p>Provide the latest KCI, CSO, and tracking exports to generate your workbook.</p>
        </div>

        <div class="upload-box">
          <!-- emptyContainer REMOVED -->
          
          <div class="upload-group">
            <label for="kciInput">KCI ‚Äì Open Repair Case Data (Excel)</label>
            <input type="file" id="kciInput" accept=".xlsx" />
          </div>

          <div class="upload-group">
            <label for="csoInput">GNPro ‚Äì CSO Status File (CSV)</label>
            <input type="file" id="csoInput" accept=".csv" />
          </div>

          <div class="upload-group">
            <label for="trackingInput">Tracking Results File (CSV)</label>
            <input type="file" id="trackingInput" accept=".csv" />
          </div>

          <button id="processBtn" disabled>Process Excel</button>
        </div>
      </section>

      <section class="panel actions-panel">
        <div class="panel-header">
          <h2>Quick actions</h2>
          <p>Use the shortcuts below to manage outputs and support tables.</p>
        </div>
        <div class="action-bar">
          <button id="copySoBtn">Copy SO Orders</button>
          <button id="copyTrackingBtn">Copy Tracking URLs</button>
          <button id="sbdBtn">SBD Cut Off Times</button>
          <button id="tlBtn">TL</button>
          <button id="marketBtn">Market</button>
          <button id="processRepairBtn">Process Repair Data</button>
        </div>
        <div class="action-note">
          <span class="note-title">Tip:</span>
          Run ‚ÄúProcess Repair Data‚Äù after updating TL, Market, and SBD assignments.
        </div>
      </section>
    </div>

  </div>
  <!-- ‚úÖ END CONTROL CENTER -->

  <div id="tablesContainer"></div>
</div>

  <!-- Modal -->
  <div id="soModal" class="modal-overlay" style="display:none;">
    <div class="modal modal-polished modal-medium">
  
      <!-- Header -->
      <h3 id="soModalTitle">Copy SO Orders Preview</h3>
  
      <!-- Body -->
      <div class="so-modal-body">
        <div id="soCount" class="so-count"></div>
        <textarea id="soOutput" readonly></textarea>
      </div>
  
      <!-- Footer -->
      <div class="modal-actions">
        <button id="copyToClipboardBtn">Copy to Clipboard</button>
        <button id="closeModalBtn">Close</button>
      </div>
  
    </div>
  </div>

  <div id="tlModal" class="modal-overlay" style="display:none;">
    <div class="modal modal-polished modal-medium">
    <h3>TL Assignment</h3>
    
    <div class="tl-market-scroll">
      <div id="tlContainer" class="mapping-grid"></div>
    </div>
    
    <button class="add-btn" id="addTlBtn">+ Add TL</button>
    
    <div class="modal-actions">
        <button id="saveTlBtn">Save</button>
        <button onclick="closeModal('tlModal')">Close</button>
      </div>
    </div>
  </div>

  <div id="marketModal" class="modal-overlay" style="display:none;">
    <div class="modal modal-polished modal-medium">
    <h3>Market Assignment</h3>
    
    <div class="tl-market-scroll">
      <div id="marketContainer" class="mapping-grid"></div>
    </div>
    
    <button class="add-btn" id="addMarketBtn">+ Add Market</button>
    
    <div class="modal-actions">
        <button id="saveMarketBtn">Save</button>
        <button onclick="closeModal('marketModal')">Close</button>
      </div>
    </div>
  </div>

<!-- Libraries -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

<div id="sbdModal" class="modal-overlay" style="display:none;">
  <div class="modal sbd-modal modal-polished modal-large">
    <h3>SBD Cut Off Times</h3>

    <div class="sbd-periods">
      <!-- Periods injected by JS -->
    </div>

    <div class="modal-actions">
      <button id="saveSbdBtn">Save</button>
      <button id="closeSbdBtn">Close</button>
    </div>
  </div>
</div>

<!-- ===== GLOBAL PROGRESS OVERLAY ===== -->
<div id="progressOverlay" class="progress-overlay" style="display:none;">
  <div class="progress-card">
    <div id="overlayStatusText" class="overlay-status"></div>

    <div class="overlay-progress-bar">
      <div id="overlayProgressBar">
        <span id="overlayProgressText">0%</span>
      </div>
    </div>

    <button
      id="overlayConfirmBtn"
      class="overlay-confirm"
      style="display:none;"
    >
      OK
    </button>
  </div>
</div>

<!-- App JS -->
<script src="index.js"></script>
<script src="https://cdn.datatables.net/fixedheader/3.4.0/js/dataTables.fixedHeader.min.js"></script>

</body>

</html>





























